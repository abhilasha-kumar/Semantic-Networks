---
title: "Semantic Networks Analysis"
author: "Abhilasha Kumar"
date: "January 16, 2018"
output:
  pdf_document: default
  html_document:
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Reading the Data

``` {r warning=F, message=F}
library(dplyr)
sem = read.csv("NetworksProject_AllSubjects.csv", header = TRUE, sep = ",")
sem$mean_len = as.double(as.character(sem$mean_len))
sem$mean_logf = as.double(as.character(sem$mean_logf))
sem$mean_ldtz = as.double(as.character(sem$mean_ldtz))
sem$mean_nmgz = as.double(as.character(sem$mean_nmgz))
sem$undirected = as.double(as.character(sem$undirected))
sem$directed = as.double(as.character(sem$directed))
sem$logp = as.double(as.character(sem$logp))

sem$mean_len = round(sem$mean_len, 2)
sem$mean_logf = round(sem$mean_logf, 2)
sem$mean_ldtz = round(sem$mean_ldtz, 2)
sem$mean_nmgz = round(sem$mean_nmgz, 2)

itemlist = read.csv("KenettCompleteItemList.csv", header = TRUE, sep = ",")
colnames(itemlist) = c("prime_word", "target_word", "ItemNo", "List", "proc")
itemlist$prime_word = paste(itemlist$prime_word, "")
itemlist$target_word = paste(itemlist$target_word, "")
sem$prime_word = as.character(sem$prime_word)
sem$target_word = as.character(sem$target_word)
sem$proc = as.character(sem$proc)
itemlist$proc = as.character(itemlist$proc)

## Problem in ITEM NAIVE-INTEREST due to coding issues 
## So we replae this item by simple text

sem$prime_word = ifelse(sem$prime_word == "NAÃ\u008fVE ", "NA\xecVE ", 
                        sem$prime_word)
sem$target_word = ifelse(sem$target_word == "NAÃ\u008fVE ", "NA\xecVE ", 
                        sem$target_word)

sem = inner_join(sem, itemlist, by = c("prime_word", 
                                          "target_word", "proc"))

sem = sem[order(sem$subject),]

kenettproc= group_by(sem, ItemNo) %>%
  summarise(items = n())

```
# Related-Unrelated Decisions
``` {r  warning=F, message=F}
library(dplyr)

sem_decision = group_by(sem, subject, pathlength, Type ) %>%
  summarize(Trials = n())

sem_subjectrows  = group_by(sem_decision, subject) %>%
  summarise(numrows = n())
rows = which(sem_subjectrows$numrows < 12)

subjects = sem_subjectrows[rows,]

# With N = 80, there are 12 rowas missing!

sem_decision[949,] = c("42406", 15, "Related", 0)
sem_decision[950,] = c("61558", 15, "Related", 0)
sem_decision[951,] = c("27113", 15, "Related", 0)
sem_decision[952,] = c("34686", 6, "Related", 0)
sem_decision[953,] = c("81385", 6, "Related", 0)
sem_decision[954,] = c("35312", 3, "Related", 0)
sem_decision[955,] = c("65089", 1, "Unrelated", 0)
sem_decision[956,] = c("65448", 4, "Related", 0)
sem_decision[957,] = c("65448", 15, "Related", 0)
sem_decision[958,] = c("84694", 6, "Related", 0)

sem_decision[959,] = c("7416", 15, "Related", 0)
sem_decision[960,] = c("79426", 15, "Related", 0)



sem_decision$Trials = as.numeric(as.character(sem_decision$Trials))

sem_decision_agg = group_by(sem_decision, pathlength, Type ) %>%
  summarise_at(vars(Trials), mean)
```


### Plotting Proportions

``` {r warning=F, message=F, fig.align='center'}
sem_decision$Trials = as.numeric(as.character(sem_decision$Trials))
sem_decision_agg$Trials = as.numeric(as.character(sem_decision_agg$Trials))

sem_decision$proportion = sem_decision$Trials/40


sem_decision_agg$proportion = sem_decision_agg$Trials/(40)

sem_decision$pathlengthfac = ordered(as.factor(as.character(sem_decision$pathlength)), 
                            levels = c("1", "2", "3", "4", "6", "15"))

sem_decision_agg$pathlengthfac = ordered(as.factor(as.character(sem_decision_agg$pathlength)), 
                            levels = c("1", "2", "3", "4", "6","15"))

library(ggplot2)
library(ggthemes)

sem_decision_agg = sem_decision_agg[order(sem_decision_agg$pathlength,
                                          sem_decision_agg$Type),]

sem_decision_agg %>% mutate(WordPair = factor(Type, 
                                        levels = unique(Type),
                    labels = c("Related", "Unrelated")))%>%
  ggplot(aes(x = pathlengthfac, y = proportion, 
                              fill = WordPair, group = WordPair))+
 geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 #geom_errorbar(aes(ymin=Trials - ci, ymax=Trials + ci), 
  #           width=.2, color = "gray26", 
   #          position = position_dodge(0.7))+
 theme_few()+
 scale_fill_solarized()+
    xlab("Path Length") + ylab("Proportion of Trials") + 
  ggtitle("Subject-Level Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```


### Subject-Wise

``` {r warning=F, message=F}
sem_decision$subject = as.factor(as.character(sem_decision$subject))


sem_decision = sem_decision[order(sem_decision$subject, 
                                  sem_decision$pathlength, 
                                  sem_decision$Type),]

sem_decision %>% mutate(WordPair = factor(Type, 
                                        levels = unique(Type),
                    labels = c("Related", "Unrelated")))%>%
  ggplot(aes(x = pathlengthfac, y = proportion, 
                              color = WordPair, group = WordPair))+
  geom_line()+
# geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 #geom_errorbar(aes(ymin=Trials - ci, ymax=Trials + ci), 
  #           width=.2, color = "gray26", 
   #          position = position_dodge(0.7))+
 theme_few()+
 scale_fill_solarized()+
  facet_wrap(~subject)+
    xlab("Path Length") + ylab("Proportion of Trials") + 
  ggtitle("Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

### Line Plot Subject-Wise

``` {r warning=F, message=F}
sem_decision$subject = as.factor(as.character(sem_decision$subject))


sem_decision = sem_decision[order(sem_decision$subject, 
                                  sem_decision$pathlength, 
                                  sem_decision$Type),]

sem_decision %>% mutate(WordPair = factor(Type, 
                                        levels = unique(Type),
                    labels = c("Related", "Unrelated")))%>%
  ggplot(aes(x = pathlengthfac, y = proportion,
             color = WordPair, group=interaction(WordPair, subject))) + 
  geom_point()+
 geom_line() + 
 theme_few()+
 scale_fill_solarized()+
 # facet_wrap(~subject)+
    xlab("Path Length") + ylab("Proportion of Trials") + 
  ggtitle("Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

### ANOVA

```{r}
relunrel_aov = aov(data = sem_decision, proportion ~ pathlengthfac*Type + 
                     Error(subject/(pathlengthfac*Type)))
summary(relunrel_aov)

options(contrasts = c('contr.sum', 'contr.poly'))
 library(lsmeans)
 library(multcomp)
 sem_lsm = lsmeans::lsmeans(relunrel_aov, c("pathlengthfac", "Type"))
 prime_effect = cld(sem_lsm, alpha = 0.05, 
                 adjust = "tukey", details = TRUE, by = "pathlengthfac")
 library(knitr)
kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.05))
```


#Raw Reaction Time

```{r}
sem_rt = group_by(sem, subject, pathlength ) %>%
  summarise_at(vars(rt), mean)

sem_rt_agg = group_by(sem, pathlength ) %>%
  summarise_at(vars(rt), mean)

sem_agg_rmisc = Rmisc::summarySE(sem_rt, 
                        measurevar = "rt",
                        groupvars = c("pathlength"))
```

### ANOVA

```{r}
sem_rt$pathlengthfac = ordered(as.factor(as.character(sem_rt$pathlength)), 
                            levels = c("1", "2", "3", "4", "6", "15"))
sem_rt$subject = as.factor(sem_rt$subject)
rt_aov = aov(data = sem_rt, rt ~ pathlengthfac + 
                     Error(subject/(pathlengthfac)))
summary(rt_aov)
```

### Plotting RTs

``` {r  }

sem_agg_rmisc$pathlengthfac = ordered(as.factor(as.character(sem_agg_rmisc$pathlength)),                             levels = c("1", "2", "3", "4",  "6", "15"))

library(ggplot2)
library(ggthemes)

sem_agg_rmisc %>% 
  ggplot(aes(x = pathlengthfac, y = rt, group = 1))+
  geom_point()+
  geom_line(color = "red")+
   geom_errorbar(aes(ymin=rt - ci, ymax=rt + ci), 
             width=.2, color = "gray26", 
             position = position_dodge(0.7))+
 theme_few()+
 # scale_x_continuous(breaks = c(1,2,3,4,5,6,10,15,20))+
    xlab("Path Length") + ylab("Reaction Time") + 
  ggtitle("RT for Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

### Subject-Wise

``` {r  }

library(ggplot2)
library(ggthemes)

sem_rt %>% 
  ggplot(aes(x = pathlengthfac, y = rt, 
             group = subject, color = subject))+
  geom_point()+
  geom_line()+
   #geom_errorbar(aes(ymin=Trials - ci, ymax=Trials + ci), 
  #           width=.2, color = "gray26", 
   #          position = position_dodge(0.7))+
 theme_few()+
  guides(color = FALSE)+
 # scale_x_continuous(breaks = c(1,2,3,4,6,15))+
    xlab("Path Length") + ylab("Reaction Time") + 
  ggtitle("RT for Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_blank(),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

# z-scored Reaction Time

## Histogram of RT

``` {r  }
library(ggplot2)
library(ggthemes)
ggplot(sem, aes(x = rt))+
geom_histogram(binwidth = 200, color = "gray4", fill = "goldenrod1")+
    theme_few()+
  #facet_wrap(~subject)+
  xlab("Raw RT") + ylab("Count") + 
  ggtitle("Raw RT Histogram for All Trials")
```

## First Trim

``` {r  }
library(dplyr)
sem_firsttrim = sem %>% filter( rt > 250 & rt < 2000)
ggplot(sem_firsttrim, aes(x = rt))+
geom_histogram(binwidth = 50, color = "gray4", fill = "goldenrod1")+
    theme_few()+
  #facet_wrap(~subject)+
  xlab("Raw RT") + ylab("Count") + 
  ggtitle("Raw RT Histogram for Trials Above 250 ms and below 2000 ms")
```

## Raw RT aggregates After Trimming

``` {r  }
sem_rt_firsttrim = group_by(sem_firsttrim, subject, pathlength ) %>%
  summarise_at(vars(rt), mean)

sem_rt_agg_firsttrim = group_by(sem_firsttrim, pathlength ) %>%
  summarise_at(vars(rt), mean)

sem_rt_agg_firsttrim$pathlengthfac = ordered(as.factor(as.character(sem_rt_agg_firsttrim$pathlength)),                             levels = c("1", "2", "3", "4", "6", "15"))

library(ggplot2)
library(ggthemes)

sem_rt_agg_firsttrim %>% 
  ggplot(aes(x = pathlengthfac, y = rt, group = 1))+
  geom_point()+
  geom_line(color = "red")+
   #geom_errorbar(aes(ymin=Trials - ci, ymax=Trials + ci), 
  #           width=.2, color = "gray26", 
   #          position = position_dodge(0.7))+
 theme_few()+
  #scale_x_continuous(breaks = c(1,2,3,4,6,15))+
    xlab("Path Length") + ylab("Reaction Time") + 
  ggtitle("RT for Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

## Subject Raw RT again


``` {r  }

library(ggplot2)
library(ggthemes)

sem_rt_firsttrim$pathlengthfac = ordered(as.factor(as.character(sem_rt_firsttrim$pathlength)), 
                            levels = c("1", "2", "3", "4", "6", "15"))
sem_rt_firsttrim$subject = as.factor(sem_rt_firsttrim$subject)
sem_rt_firsttrim %>% 
  ggplot(aes(x = pathlengthfac, y = rt,
             group = subject, color = subject))+
  geom_point()+
  geom_line()+
   #geom_errorbar(aes(ymin=Trials - ci, ymax=Trials + ci), 
  #           width=.2, color = "gray26", 
   #          position = position_dodge(0.7))+
 theme_few()+
  guides(color = FALSE)+
#  scale_x_continuous(breaks = c(1,2,3,4,5,6,10,15,20))+
    xlab("Path Length") + ylab("Reaction Time") + 
  ggtitle("RT for Relatedness Judgments")  +
 # facet_wrap(~subject)+
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

## Making the z-scores
``` {r  }
## aggregate per subject all IVs and DVs
meanRT = group_by(sem_firsttrim, subject) %>%
  summarise_at(vars(rt), mean)
colnames(meanRT) = c("subject", "MeanRT")

sdRT = group_by(sem_firsttrim, subject) %>%
  summarise_at(vars(rt), sd)
colnames(sdRT) = c("subject", "sdRT")

RT_agg = merge(meanRT, sdRT, by = "subject")

## merge aggregate info with long data
sem_z = merge(sem_firsttrim, RT_agg, by = "subject", all.x = T)

## person and grand-mean centered scores using original and aggregate
library(dplyr)
sem_z = sem_z %>% mutate(zRT = (rt - MeanRT)/sdRT)
                 
## checking: subject level means should be zero

sub_pic = group_by(sem_z, subject) %>%
  summarise_at(vars(zRT), mean)

```
## z-RT Distribution
``` {r  }
ggplot(sem_z, aes(x = zRT))+
geom_histogram(binwidth = 0.5, color = "gray4", fill = "goldenrod1")+
    theme_few()+
  xlab("z RT") + ylab("Count") + 
  ggtitle("z-RT Histogram for above 250 ms & <2s Trials")
```

## Trimming z-RT

``` {r  }
sem_z_trimmed = subset(sem_z, sem_z$zRT < 3 & sem_z$zRT > -3)

ggplot(sem_z_trimmed, aes(x = zRT))+
geom_histogram(binwidth = 0.25, color = "gray4", fill = "goldenrod1")+
    theme_few()+
  xlab("Raw RT") + ylab("Count") + 
  ggtitle("Trimmed (3 SD) z-RT Histogram for above 250 ms & <2s Trials")
```

## Repeating z-scoring

``` {r  }
library(dplyr)

## aggregate per subject all IVs and DVs
meanRT_trim = group_by(sem_z_trimmed, subject) %>%
  summarise_at(vars(rt), mean)
colnames(meanRT_trim) = c("subject", "MeanRT_trim")

sdRT_trim = group_by(sem_z_trimmed, subject) %>%
  summarise_at(vars(rt), sd)
colnames(sdRT_trim) = c("subject", "sdRT_trim")

RT_agg_trim = merge(meanRT_trim, sdRT_trim, by = "subject")

## merge aggregate info with long data
new_sem_z = merge(sem_z_trimmed, RT_agg_trim, by = "subject", all.x = T)

## person and grand-mean centered scores using original and aggregate
library(dplyr)
new_sem_z = new_sem_z %>% mutate(zRT_trim = (rt - MeanRT_trim)/sdRT_trim)
                 
## checking: subject level means should be zero

sub_pic = group_by(new_sem_z, subject) %>%
  summarise_at(vars(zRT_trim), mean)

#write.csv(new_pic_z, file="final_pic_z.csv")
```

## Aggregating zRT
``` {r}
z_sem_rt = group_by(new_sem_z, subject, pathlength ) %>%
  summarise_at(vars(zRT_trim, rt), mean)

z_sem_rt_rel = group_by(new_sem_z, subject, pathlength, Type ) %>%
  summarise_at(vars(zRT_trim, rt), mean)

z_sem_rt_agg = group_by(new_sem_z, pathlength ) %>%
  summarise_at(vars(zRT_trim), mean)

z_rmisc = Rmisc::summarySE(new_sem_z, 
                        measurevar = "zRT_trim",
                        groupvars = c("pathlength"))

z_sem_rt_rel_agg = group_by(new_sem_z, pathlength, Type ) %>%
  summarise_at(vars(zRT_trim), mean)

z_sem_rt_rel_agg_rmisc = Rmisc::summarySE(new_sem_z, 
                        measurevar = "zRT_trim",
                        groupvars = c("pathlength", "Type"))
```

## ANOVA
```{r}
z_sem_rt$pathlengthfac = ordered(as.factor(as.character(z_sem_rt$pathlength)), 
                            levels = c("1", "2", "3", "4", "6", "15"))
z_sem_rt$subject = as.factor(z_sem_rt$subject)

z_rt_aov = aov(data = z_sem_rt, zRT_trim ~ pathlengthfac + 
                     Error(subject/(pathlengthfac)))
summary(z_rt_aov)

options(contrasts = c('contr.sum', 'contr.poly'))
 library(lsmeans)
 library(multcomp)
 sem_lsm = lsmeans::lsmeans(z_rt_aov, c("pathlengthfac"))
 prime_effect = cld(sem_lsm, alpha = 0.05, 
                 adjust = "tukey", details = TRUE)
 library(knitr)
kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.1 ))

```

## Specific t-tests

```{r}
z_1 = z_sem_rt %>% filter(pathlength == "1")
colnames(z_1) = c("subject","pathlength1", "zRT_1", "RawRT_1", "pathlengthfac1")
z_2 = z_sem_rt %>% filter(pathlength == "2")
colnames(z_2) = c("subject","pathlength2", "zRT_2", "RawRT_2", "pathlengthfac2")
z_3 = z_sem_rt %>% filter(pathlength == "3")
colnames(z_3) = c("subject","pathlength3", "zRT_3", "RawRT_3", "pathlengthfac3")
z_4 = z_sem_rt %>% filter(pathlength == "4")
colnames(z_4) = c("subject","pathlength4", "zRT_4", "RawRT_4", "pathlengthfac4")
z_6 = z_sem_rt %>% filter(pathlength == "6")
colnames(z_6) = c("subject","pathlength6", "zRT_6", "RawRT_6", "pathlengthfac6")
z_15 = z_sem_rt %>% filter(pathlength == "15")
colnames(z_15) = c("subject","pathlength15", "zRT_15", "RawRT_15", "pathlengthfac15")


z_all = Reduce(function(x, y) merge(x, y, all=TRUE, by = "subject"), 
               list(z_1, z_2, z_3, z_4,z_6,z_15))
z_all = z_all[,-c(2,5,6,9,10,13,14,17,18,21,22,25)]

t.test(z_all$zRT_1, z_all$zRT_2, paired = TRUE)
t.test(z_all$zRT_2, z_all$zRT_3, paired = TRUE)
t.test(z_all$zRT_3, z_all$zRT_4, paired = TRUE)
t.test(z_all$zRT_4, z_all$zRT_6, paired = TRUE)
t.test(z_all$zRT_6, z_all$zRT_15, paired = TRUE)

```


## Plotting RTs: collapsed 

```{r}

z_rmisc$pathlengthfac = ordered(as.factor(as.character(z_rmisc$pathlength)),                             levels = c("1", "2", "3", "4", "6", "15"))

z_rmisc$zRT_trim = as.numeric(z_rmisc$zRT_trim)

library(ggplot2)
library(ggthemes)

z_rmisc %>% 
  ggplot(aes(x = pathlengthfac, y = zRT_trim, group = 1))+
  geom_point()+
#  geom_smooth(method = "loess")+
geom_line(color = "red")+
   geom_errorbar(aes(ymin=zRT_trim - ci, ymax=zRT_trim + ci), 
             width=.05, color = "gray30", 
             position = position_dodge(0.7))+
 theme_few()+
  #scale_x_continuous(breaks = c(1,2,3,4,5,6,10,15,20))+
    xlab("Path Length") + ylab("z-RT") + 
  ggtitle("z-RT for Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

## Plotting RTs: Rel-Unrel 

``` {r  }

z_sem_rt_rel_agg_rmisc$pathlengthfac = ordered(as.factor(as.character(z_sem_rt_rel_agg_rmisc$pathlength)),                             levels = c("1", "2", "3", "4", "6", "15"))

z_sem_rt_rel_agg_rmisc$zRT_trim = as.numeric(z_sem_rt_rel_agg_rmisc$zRT_trim)

library(ggplot2)
library(ggthemes)

z_sem_rt_rel_agg_rmisc %>% 
  ggplot(aes(x = pathlengthfac, y = zRT_trim, group = Type, color = Type))+
  geom_point()+
#  geom_smooth(method = "loess")+
geom_line()+
  geom_errorbar(aes(ymin=zRT_trim - ci, ymax=zRT_trim + ci), 
             width=.05, color = "gray30", 
             position = position_dodge(0.05))+
 theme_few()+
  #scale_x_continuous(breaks = c(1,2,3,4,5,6,10,15,20))+
    xlab("Path Length") + ylab("z-RT") + 
  ggtitle("z-RT for Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

## Plotting RTs: Subject Wise Rel-Unrel 

``` {r  }

z_sem_rt_rel$pathlengthfac = ordered(as.factor(as.character(z_sem_rt_rel$pathlength)),                             levels = c("1", "2", "3", "4", "6", "15"))

z_sem_rt_rel$zRT_trim = as.numeric(z_sem_rt_rel$zRT_trim)

library(ggplot2)
library(ggthemes)

z_sem_rt_rel %>% 
  ggplot(aes(x = pathlengthfac, y = zRT_trim, color = Type, group=interaction(Type, subject))) + 
  geom_point()+
#  geom_smooth(method = "loess")+
geom_line()+
 theme_few()+
  facet_wrap(~subject)+
  #scale_x_continuous(breaks = c(1,2,3,4,5,6,10,15,20))+
    xlab("Path Length") + ylab("z-RT") + 
  ggtitle("z-RT for Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

## Quadratic Trend

```{r}
z_sem_rt %>% 
  ggplot(aes(x = pathlength, y = zRT_trim))+
  geom_point(color = "black", size = 1)+
  geom_smooth(method = "loess", color = "red")+
   #geom_errorbar(aes(ymin=Trials - ci, ymax=Trials + ci), 
  #           width=.2, color = "gray26", 
   #          position = position_dodge(0.7))+
 theme_few()+
 # scale_x_continuous(breaks = c(1,2,3,4,5,6,10,15,20))+
    xlab("Path Length") + ylab("z-RT") + 
  ggtitle("z-RT for Relatedness Judgments")  +
 # facet_wrap(~subject)+
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```


## Subject-Wise

``` {r  }

library(ggplot2)
library(ggthemes)

 

z_sem_rt %>% 
  ggplot(aes(x = pathlengthfac, y = zRT_trim,
             color = subject, group = subject))+
  geom_point(color = "black", size = 1)+
  geom_line()+
   #geom_errorbar(aes(ymin=Trials - ci, ymax=Trials + ci), 
  #           width=.2, color = "gray26", 
   #          position = position_dodge(0.7))+
 theme_few()+
  guides(color = FALSE)+
 # scale_x_continuous(breaks = c(1,2,3,4,5,6,10,15,20))+
    xlab("Path Length") + ylab("z-RT") + 
  ggtitle("z-RT for Relatedness Judgments")  +
 # facet_wrap(~subject)+
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

# Regressions
``` {r  }
library(lme4)
sem$pathlengthfac = ordered(as.factor(as.character(sem$pathlength)), 
                            levels = c("1", "2", "3", "4", "6","15"))

new_sem_z$pathlengthfac = ordered(as.factor(as.character(new_sem_z$pathlength)), 
                            levels = c("1", "2", "3", "4", "6","15"))
 
m0 = lmer(data = new_sem_z, rt ~ 1 + (1|subject) + (1|trial_index) +
            (1|ItemNo))
summary(m0)
reghelper::ICC(m0)

contrasts(sem$pathlengthfac) = contr.treatment(6, base = 1)


contrasts(new_sem_z$pathlengthfac) = contr.treatment(6, base = 2)

m1_fixed = lmer(data = new_sem_z, zRT_trim ~ pathlengthfac +
           (1|subject) + (1|ItemNo) + (1|trial_index))
summary(m1_fixed)

m1_random = lmer(data = sem, rt ~ pathlengthfac +
           (pathlengthfac|subject) + (pathlengthfac|ItemNo) + 
             (pathlengthfac|trial_index))
summary(m1_random)
```

## ELP Model

```{r}
## Adding ELP covariates

elp_model = lmer(data = new_sem_z, rt ~ mean_len + mean_logf +
                   mean_ldtz + 
           (1|subject) + (1|trial_index) + (1|ItemNo))
fit_from_elp = broom::augment(elp_model,new_sem_z)
 
contrasts(fit_from_elp$pathlengthfac) = contr.treatment(6, base = 2)
 
m1_fixed_elp = lmer(data = fit_from_elp, .resid ~ pathlengthfac +
           (1|subject) + (1|trial_index) + (1|ItemNo))
 summary(m1_fixed_elp)
 
 m1_all_elp = lmer(data = new_sem_z, rt ~ pathlengthfac +
                     mean_len + mean_logf + mean_ldtz + 
           (1|subject) + (1|trial_index) + (1|ItemNo))
 summary(m1_all_elp)
```


### Plot from ELP Model

```{r}
fixed.frame <- 
  data.frame(expand.grid( pathlengthfac = c("1","2", "3",
                                            "4", "6", "15"))) %>%
  mutate(pred = predict(m1_all_elp, newdata = ., re.form = NA))


fixed.frame %>% 
  mutate(Pathlength = factor(pathlengthfac, 
    levels = unique(pathlengthfac),
                    labels = c("1","2", "3",
                               "4", "6", "15")))%>%
ggplot(aes(x = Pathlength, y = pred, group = 1))+
  geom_point()+
geom_line(color = "green")+
 theme_few()+
  xlab("Path Length") + ylab("RT residuals ") + 
  ggtitle("z-RT for Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

```



# Concreteness Norms

```{r}
elpnorms = read.csv("ELP_norms.csv", header = TRUE, sep = ",")
elpnorms = elpnorms[,c(1,2)]
colnames(elpnorms) = c("prime_word", "prime_concreteness")
elpnorms$prime_word = toupper(elpnorms$prime_word)
elpnorms$prime_word = paste(elpnorms$prime_word, "")

elpnorms$prime_word = as.character(elpnorms$prime_word)

sem$prime_word = as.character(sem$prime_word)
merged_sem_prime= inner_join(sem, elpnorms, by = "prime_word")
merged_sem_prime = merged_sem_prime[,c(4,7,16,41)]

colnames(elpnorms) = c("target_word", "target_concreteness")
sem$target_word = as.character(sem$target_word)
merged_sem_target= inner_join(sem, elpnorms, by = "target_word")
merged_sem_target = merged_sem_target[,c(4,7, 17,41)]

merged_concretness = full_join(merged_sem_prime, merged_sem_target,
                           by = c("trial_index", "subject"))
merged_concretness$mean_conc = (merged_concretness$prime_concreteness +
                                merged_concretness$target_concreteness) / 2

### NOW WE HAVE CONCRETENESS NORMS FOR ALL ITEMS IN THE DATASET
### NEED TO COMBINE THIS WITH ACTUAL SEM DATA

new_sem_z$prime_word = as.character(new_sem_z$prime_word)
new_sem_z$target_word = as.character(new_sem_z$target_word)
final_sem = inner_join(new_sem_z, merged_concretness, 
                      by = c("trial_index", "subject", 
                             "prime_word", "target_word") )

```

### Conreteness Model

```{r}
final_sem$pathlengthfac = ordered(as.factor(as.character(final_sem$pathlength)), 
                            levels = c("1", "2", "3", "4", "6","15"))
 
elp_model = lmer(data = final_sem, zRT_trim ~ mean_len + mean_logf +
                   mean_ldtz + mean_conc +
           (1|subject) + (1|trial_index) + (1|ItemNo))
fit_from_elp = broom::augment(elp_model,final_sem)
 
contrasts(fit_from_elp$pathlengthfac) = contr.treatment(6, base = 2)
 
m1_fixed_elp = lmer(data = fit_from_elp, .resid ~ pathlengthfac +
           (1|subject) + (1|trial_index) + (1|ItemNo))
 summary(m1_fixed_elp)
 
 contrasts(final_sem$pathlengthfac) = contr.treatment(6, base = 2)

 m1_all_elp = lme4::lmer(data = final_sem, zRT_trim ~ pathlengthfac +
                     mean_len + mean_logf + mean_ldtz + mean_conc +
           (1|subject) + (1|trial_index) + (1|ItemNo))
 summary(m1_all_elp)
 
 m1_all_elp_random = lme4::lmer(data = final_sem, zRT_trim ~ pathlengthfac +
                     mean_len + mean_logf + mean_ldtz + mean_conc +
           (pathlengthfac|subject) + 
              + (1|trial_index) + (pathlengthfac|ItemNo),
    control=lmerControl(optimizer="bobyqa",
            optCtrl=list(maxfun=1000000)))
 summary(m1_all_elp_random)
 
 m1_all_elp_type = lme4::lmer(data = final_sem, 
                              zRT_trim ~ pathlengthfac*Type +
                     mean_len + mean_logf + mean_ldtz + mean_conc +
           (1|subject) + (1|trial_index) +
              + (1|target_word))
 summary(m1_all_elp_type)
 
```
### Plot
```{r}

mean_length = mean(final_sem$mean_len, na.rm = TRUE)
mean_logfreq = mean(final_sem$mean_logf, na.rm = TRUE)
mean_lexdec = mean(final_sem$mean_ldtz, na.rm = TRUE)
mean_concreteness = mean(final_sem$mean_conc, na.rm = TRUE)


fixed.frame <- 
  data.frame(expand.grid( pathlengthfac = c("1","2", "3",
                                            "4", "6", "15"), 
                          Type= c("Related", "Unrelated"),
                          mean_len = mean_length,
                          mean_logf = mean_logfreq,
                          mean_ldtz = mean_lexdec,
                          mean_conc = mean_concreteness)) %>%
  mutate(pred = predict(m1_all_elp_type, newdata = ., re.form = NA))


fixed.frame %>% 
  mutate(Pathlength = factor(pathlengthfac, 
    levels = unique(pathlengthfac),
                    labels = c("1","2", "3",
                               "4", "6", "15")))%>%
ggplot(aes(x = Pathlength, y = pred, group = Type, color = Type))+
  geom_point()+
  geom_line()+
#  geom_smooth(method = "loess")+
#geom_line(color = "green")+
 theme_few()+
  xlab("Path Length") + ylab("z-scored RT") + 
  ggtitle("z-scored RT for Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

### SjPlot Model

```{r}
x = sjPlot::plot_model(m1_all_elp_type, type = "int")
x + theme_few()+
      xlab("Kenett Path Lengths") + 
  ylab("Predicted z-scored Reaction Time") + 
ggtitle("Model Fit for z-RT ~ PathLength * Type") +
  theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```


# Quadratic Model

```{r}
## TESTING QUADRATIC TREND
m3_linear = lmer(data = final_sem, zRT_trim~ pathlength  +
                     mean_len + mean_logf + mean_ldtz + mean_conc +
           (1|subject) + (1|trial_index) +
              + (1|target_word))
summary(m3_linear)
m3_quad = lmer(data = final_sem, zRT_trim ~ pathlength + I((pathlength)^2) +
                     mean_len + mean_logf + mean_ldtz + mean_conc +
           (1|subject) + (1|trial_index) +
              + (1|target_word))
summary(m3_quad)

anova(m3_linear, m3_quad)
sjPlot::sjp.lm(m3_quad, type = "poly", poly.term = "pathlength")

```

# Other Networks

## Kenett Path Length

```{r}
items_kenett = group_by(final_sem, pathlength) %>%
  summarise(items = n())

items_kenett$pathlength = as.factor(items_kenett$pathlength)
ggplot(items_kenett, aes(x = pathlength, y = items))+
 geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 theme_few()+
  xlab("Kenett Path Length") + ylab("Number of Items") + 
  ggtitle("Kenett Item Distribution")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```


## Undirected
```{r}
items_undirected = group_by(final_sem, undirected) %>%
  summarise(items = n())

items_undirected_subject = group_by(final_sem, subject, undirected) %>%
  summarise(items = n())

undirected_rmisc = Rmisc::summarySE(items_undirected_subject, 
                        measurevar = "items",
                        groupvars = c("undirected"))


final_sem$undirectedfac = ordered(as.factor(as.character(final_sem$undirected)), 
                            levels = c("1", "2", "3", "4"))
contrasts(final_sem$undirectedfac) = contr.treatment(4, base = 2)

m_undirected = lmer(data = final_sem, zRT_trim~ undirectedfac +
                     mean_len + mean_logf + mean_ldtz + mean_conc +
           (1|subject) + (1|trial_index) +
              + (1|target_word))
summary(m_undirected)

m_undirected_type = lmer(data = final_sem, zRT_trim~ undirectedfac*Type +
                     mean_len + mean_logf + mean_ldtz + mean_conc +
           (1|subject) + (1|trial_index) +
              + (1|target_word))
summary(m_undirected_type)

m_undirected_linear = lmer(data = final_sem, zRT_trim~ undirected +
                     mean_len + mean_logf + mean_ldtz + mean_conc +
           (1|subject) + (1|trial_index) +
              + (1|target_word))

final_sem$quadundirected = I(final_sem$undirected ^2)
m_undirected_quad = lmer(data = final_sem, zRT_trim~ undirected + 
                           quadundirected +
                     mean_len + mean_logf + mean_ldtz + mean_conc +
           (1|subject) + (1|trial_index) +
              + (1|target_word))
summary(m_undirected_quad)

anova(m_undirected_linear, m_undirected_quad)
sjPlot::plot_model(m_undirected_quad, type = "pred", terms = "quadundirected")
```

### Plot Item Distribution

```{r}
ggplot(undirected_rmisc, aes(x = undirected, y = items))+
 geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 theme_few()+
  xlab("Non-directed Path Length") + ylab("Number of Items") + 
  ggtitle("Non-Directed Item Distribution")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

### Plot Undirected Normal
```{r}
mean_length = mean(final_sem$mean_len, na.rm = TRUE)
mean_logfreq = mean(final_sem$mean_logf, na.rm = TRUE)
mean_lexdec = mean(final_sem$mean_ldtz, na.rm = TRUE)
mean_concreteness = mean(final_sem$mean_conc, na.rm = TRUE)



 fixed.frame <-
   data.frame(expand.grid( undirectedfac = c("1", "2", "3", "4"),
                           Type = c("Related", "Unrelated"),
                           mean_len = mean_length,
                           mean_logf = mean_logfreq,
                           mean_ldtz = mean_lexdec,
                           mean_conc = mean_concreteness)) %>%
   mutate(pred = predict(m_undirected_type, newdata = ., re.form = NA))


fixed.frame %>% 
  mutate(Pathlength = factor(undirectedfac, 
    levels = unique(undirectedfac),
                    labels = c("1","2", "3","4")))%>%
ggplot(aes(x = Pathlength, y = pred, group = Type, color = Type))+
  geom_point()+
#  geom_smooth(method = "loess")+
geom_line()+
 theme_few()+
  xlab("Path Length") + ylab("z-scored RT") + 
  ggtitle("z-scored RT for Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

```

### Plot  Undirected Quadratic

```{r}
mean_length = mean(final_sem$mean_len, na.rm = TRUE)
mean_logfreq = mean(final_sem$mean_logf, na.rm = TRUE)
mean_lexdec = mean(final_sem$mean_ldtz, na.rm = TRUE)
mean_concreteness = mean(final_sem$mean_conc, na.rm = TRUE)


fixed.frame <- 
  data.frame(expand.grid( quadundirected = seq(1,16,.01),
                         undirected  = 2.49,
                          mean_len = mean_length,
                          mean_logf = mean_logfreq,
                          mean_ldtz = mean_lexdec,
                          mean_conc = mean_concreteness)) %>%
  mutate(pred = predict(m_undirected_quad, newdata = ., re.form = NA))

fixed.frame %>% 
ggplot(aes(x = quadundirected, y = pred))+
  geom_point(size = 0.1)+
 geom_smooth(method = "loess")+
#geom_line()+
 theme_few()+
  xlab("Path Length") + ylab("z-scored RT") + 
  ggtitle("z-scored RT for Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

```


### SjPlot Model

```{r}
x = sjPlot::plot_model(m_undirected_type, type = "int")
x + theme_few()+
      xlab("Non-Directed Steyvers Path Lengths") + 
  ylab("Predicted z-scored Reaction Time") + 
ggtitle("Model Fit for z-RT ~ PathLength * Type") +
  theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

## Directed
```{r}



final_sem$newdirected = ifelse(final_sem$directed == "Inf" | 
                              final_sem$directed == "NA", NA,
                              final_sem$directed)

final_sem$directedcollapsed = ifelse((final_sem$newdirected == "5" |
                                      final_sem$newdirected == "6" |
                                       final_sem$newdirected == "7" |
                                       final_sem$newdirected == "8"), "H",
                              final_sem$newdirected)

items_directed = group_by(final_sem, newdirected) %>%
  summarise(items = n())

items_directed_subject = group_by(final_sem, subject, newdirected) %>%
  summarise(items = n())

directed_rmisc = Rmisc::summarySE(items_directed_subject, 
                        measurevar = "items",
                        groupvars = c("newdirected"))


final_sem$directedfac = 
  ordered(as.factor(as.character(final_sem$newdirected)), 
                            levels = c("1", "2", "3", "4", "5", 
                                       "6", "7", "8"))
contrasts(final_sem$directedfac) = contr.treatment(8, base = 2)

final_sem$collapsedfac = 
  ordered(as.factor(as.character(final_sem$directedcollapsed)), 
                            levels = c("1", "2", "3", "4", "H"))
contrasts(final_sem$collapsedfac) = contr.treatment(5, base = 2)

m_directed = lme4::lmer(data = final_sem, zRT_trim ~ collapsedfac  +
                     mean_len + mean_logf + mean_ldtz + mean_conc +
           (1|subject) + (1|trial_index) +
              + (1|target_word))
summary(m_directed)

m_directed_type = lme4::lmer(data = final_sem, zRT_trim ~ collapsedfac*Type  +
                     mean_len + mean_logf + mean_ldtz + mean_conc +
           (1|subject) + (1|trial_index) +
              + (1|target_word))
summary(m_directed_type)
```

### Plot Item Distribution

```{r}
items_directed$newdirected = as.factor(items_directed$newdirected)
ggplot(directed_rmisc, aes(x = newdirected, y = items))+
 geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 theme_few()+
  xlab("Directed Path Length") + ylab("Number of Items") + 
  ggtitle("Directed Item Distribution")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```
### Plot Directed
```{r}

mean_length = mean(final_sem$mean_len, na.rm = TRUE)
mean_logfreq = mean(final_sem$mean_logf, na.rm = TRUE)
mean_lexdec = mean(final_sem$mean_ldtz, na.rm = TRUE)
mean_concreteness = mean(final_sem$mean_conc, na.rm = TRUE)


fixed.frame <-
  data.frame(expand.grid( collapsedfac = c("1", "2", "3", "4", "H"),
                          Type = c("Related", "Unrelated"),
                          mean_len = mean_length,
                          mean_logf = mean_logfreq,
                          mean_ldtz = mean_lexdec,
                          mean_conc = mean_concreteness)) %>%
  mutate(pred = predict(m_directed, newdata = ., re.form = NA))

# fixed.frame <- 
#   data.frame(expand.grid( newdirected = 
#                             seq(min(final_sem$newdirected, na.rm = TRUE), 
#                                 max(final_sem$newdirected, na.rm = TRUE),
#                                 1),
#                           mean_len = mean_length,
#                           mean_logf = mean_logfreq,
#                           mean_ldtz = mean_lexdec,
#                           mean_conc = mean_concreteness)) %>%
#   mutate(pred = predict(m_directed, newdata = ., re.form = NA))


fixed.frame %>% 
 mutate(Pathlength = factor(collapsedfac,
  levels = unique(collapsedfac),
                 labels = c("1","2", "3","4", "H")))%>%
ggplot(aes(x = collapsedfac, y = pred, group = Type, color = Type))+
  geom_point()+
#  geom_smooth(method = "loess")+
geom_line()+
 theme_few()+
  xlab("Path Length") + ylab("z-scored RT") + 
  ggtitle("z-scored RT for Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

### SjPlot Model

```{r}
x = sjPlot::plot_model(m_directed_type, type = "int")
x + theme_few()+
      xlab("Directed Steyvers Path Lengths") + 
  ylab("Predicted z-scored Reaction Time") + 
ggtitle("Model Fit for z-RT ~ PathLength") +
  theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```


## Log P
```{r}
final_sem$logp = round(final_sem$logp, 2)

final_sem$newlogp = ifelse(final_sem$logp == "Inf" | 
                              final_sem$logp == "NA", NA,
                              final_sem$logp)
final_sem$roundedlogp = round(final_sem$newlogp, 0)

items_logp = group_by(final_sem, roundedlogp) %>%
  summarise(items = n())

items_logp_subject = group_by(final_sem, subject, roundedlogp) %>%
  summarise(items = n())

logp_rmisc = Rmisc::summarySE(items_logp_subject, 
                        measurevar = "items",
                        groupvars = c("roundedlogp"))


m_logp = lmer(data = final_sem, zRT_trim ~ newlogp  +
                     mean_len + mean_logf + mean_ldtz + mean_conc +
           (1|subject) + (1|trial_index) +
              + (1|target_word))
summary(m_logp)

m_logp_type = lmer(data = final_sem, zRT_trim ~ newlogp*Type  +
                     mean_len + mean_logf + mean_ldtz + mean_conc +
           (1|subject) + (1|trial_index) +
              + (1|target_word))
summary(m_logp_type)
```

### Plot Item Distribution

```{r}
items_logp$roundedlogp = as.factor(items_logp$roundedlogp)
ggplot(items_logp, aes(x = roundedlogp, y = items))+
 geom_bar(stat = "identity", position = "dodge", width = 0.2, color= "black")+
 theme_few()+
  xlab("Directed Path Length") + ylab("Number of Items") + 
  ggtitle("Log P Item Distribution")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

### Plot LogP
```{r}

mean_length = mean(final_sem$mean_len, na.rm = TRUE)
mean_logfreq = mean(final_sem$mean_logf, na.rm = TRUE)
mean_lexdec = mean(final_sem$mean_ldtz, na.rm = TRUE)
mean_concreteness = mean(final_sem$mean_conc, na.rm = TRUE)

fixed.frame <- 
  data.frame(expand.grid( newlogp = 
                            seq(min(final_sem$newlogp, na.rm = TRUE), 
                                max(final_sem$newlogp, na.rm = TRUE),
                                2),
                          Type = c("Related", "Unrelated"),
                          mean_len = mean_length,
                          mean_logf = mean_logfreq,
                          mean_ldtz = mean_lexdec,
                          mean_conc = mean_concreteness)) %>%
  mutate(pred = predict(m_logp_type, newdata = ., re.form = NA))


fixed.frame %>% 
 # mutate(Pathlength = factor(directedfac, 
  #  levels = unique(directedfac),
   #                 labels = c("1","2", "3","4", 
    #                                      "5", "6", "7", "8")))%>%
ggplot(aes(x = newlogp, y = pred, group = Type, color = Type))+
  geom_point()+
#  geom_smooth(method = "loess")+
geom_line()+
 theme_few()+
  xlab("Path Length") + ylab("z-scored RT") + 
  ggtitle("z-scored RT for Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```



# z-scores for Path Lengths

```{r}
library(dplyr)
z_pathlength1 = final_sem %>% filter(pathlength == "1")
z_pathlength2 = final_sem %>% filter(pathlength == "2")
z_pathlength3 = final_sem %>% filter(pathlength == "3")
z_pathlength4 = final_sem %>% filter(pathlength == "4")
z_pathlength6 = final_sem %>% filter(pathlength == "6")
z_pathlength15 = final_sem %>% filter(pathlength == "15")


```

## Creating separate z-scores
```{r}

sem_firsttrim1 = sem_firsttrim %>% filter(pathlength == "15")

## aggregate per subject all IVs and DVs
meanRT = group_by(sem_firsttrim1, subject) %>%
  summarise_at(vars(rt), mean)
colnames(meanRT) = c("subject", "MeanRT")

sdRT = group_by(sem_firsttrim1, subject) %>%
  summarise_at(vars(rt), sd)
colnames(sdRT) = c("subject", "sdRT")

RT_agg = merge(meanRT, sdRT, by = "subject")

## merge aggregate info with long data
sem_z_1 = merge(sem_firsttrim1, RT_agg, by = "subject", all.x = T)

## person and grand-mean centered scores using original and aggregate
library(dplyr)
sem_z_1 = sem_z_1 %>% mutate(zRT = (rt - MeanRT)/sdRT)
                 
## checking: subject level means should be zero

sub_pic = group_by(sem_z_1, subject) %>%
  summarise_at(vars(zRT), mean)
```

# Item Diagnostics

```{r}
item_mean = group_by(new_sem_z, pathlength, ItemNo) %>%
  summarise_at(vars(zRT_trim), mean)

item_rel = group_by(sem, pathlength, ItemNo, Type) %>%
  summarise(Trials = n())

item_rel_rt = group_by(sem, pathlength, ItemNo, Type) %>%
  summarise_at(vars(rt), mean)

item_rt_collapsed = group_by(sem, pathlength, ItemNo) %>%
  summarise_at(vars(rt), mean)

item_rel_wide = tidyr::spread(item_rel, Type, Trials)

item_rel_rt_wide = tidyr::spread(item_rel_rt, Type, rt)

item_sub = group_by(sem, ItemNo, subject) %>%
  summarise(Subjects = n())

item_rel_wide$Related  = ifelse(is.na(item_rel_wide$Related), 0, item_rel_wide$Related)

item_rel_wide$Unrelated  = ifelse(is.na(item_rel_wide$Unrelated), 0, item_rel_wide$Unrelated)

item_rel_rt_wide$Related  = ifelse(is.na(item_rel_rt_wide$Related), 0, item_rel_rt_wide$Related)

item_rel_rt_wide$Unrelated  = ifelse(is.na(item_rel_rt_wide$Unrelated), 0, item_rel_rt_wide$Unrelated)
```


## Item-Wise Slopes for Path Lengths

### Path Length 1

```{r}
p1 = item_rel_wide %>% filter (pathlength == 1)


p1_sample = p1[1:10,]

ggplot(p1, aes(x = Related, 
                      y = Unrelated, group = ItemNo, color = ItemNo))+
  geom_point(position = "jitter")+
  #geom_line(group=1)+
  geom_text(aes(label=ItemNo),hjust=0, vjust=0) + 
 theme_few()+
    guides(color = FALSE)+
  xlab("Subjects who rated item as RELATED") + ylab("Subjects who rated item as UNRELATED") + 
  ggtitle("Item Judgments for Path Length 1")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

```

### Path Length 2

```{r}
p2 = item_rel_wide %>% filter (pathlength == 1)

p2_sample = p2[1:50,]

ggplot(p2, aes(x = Related, 
                      y = Unrelated, group = ItemNo, color = ItemNo))+
  geom_point(position = "jitter")+
  #geom_line(group=1)+
  geom_text(aes(label=ItemNo),hjust=0, vjust=0) + 
 theme_few()+
    guides(color = FALSE)+
 theme_few()+
      guides(color = FALSE)+
  xlab("Subjects who rated item as RELATED") + ylab("Subjects who rated item as UNRELATED") + 
  ggtitle("Item Judgments for Path Length 2")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

```

### Path Length 3

```{r}
p3 = item_rel_wide %>% filter (pathlength == 3)

p3_sample = p3[1:50,]

ggplot(p3, aes(x = Related, 
                      y = Unrelated, group = ItemNo, color = ItemNo))+
  geom_point(position = "jitter")+
  #geom_line(group=1)+
  geom_text(aes(label=ItemNo),hjust=0, vjust=0) + 
 theme_few()+
 
    guides(color = FALSE)+
 theme_few()+
 theme_few()+
  xlab("Subjects who rated item as RELATED") + ylab("Subjects who rated item as UNRELATED") + 
  ggtitle("Item Judgments for Path Length 3")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

```

### Path Length 4

```{r}
p4 = item_rel_wide %>% filter (pathlength == 4)

p4_sample = p4[1:50,]

ggplot(p4, aes(x = Related, 
                      y = Unrelated, group = ItemNo, color = ItemNo))+
  geom_point(position = "jitter")+
  #geom_line(group=1)+
  geom_text(aes(label=ItemNo),hjust=0, vjust=0) + 
 theme_few()+
    guides(color = FALSE)+
 theme_few()+
    guides(color = FALSE)+
  xlab("Subjects who rated item as RELATED") + ylab("Subjects who rated item as UNRELATED") + 
  ggtitle("Item Judgments for Path Length 4")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

```

### Path Length 6

```{r}
p6 = item_rel_wide %>% filter (pathlength == 6)

p6_sample = p6[1:50,]

ggplot(p6, aes(x = Related, 
                      y = Unrelated, group = ItemNo, color = ItemNo))+
  geom_point(position = "jitter")+
  #geom_line(group=1)+
  geom_text(aes(label=ItemNo),hjust=0, vjust=0) + 
 theme_few()+
    guides(color = FALSE)+
 theme_few()+
  guides(color = FALSE)+
  xlab("Subjects who rated item as RELATED") + ylab("Subjects who rated item as UNRELATED") + 
  ggtitle("Item Judgments for Path Length 6")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

```

### Path Length 15

```{r}
p15 = item_rel_wide %>% filter (pathlength == 15)

p15_sample = p15[1:50,]

ggplot(p15, aes(x = Related, 
                      y = Unrelated, group = ItemNo, color = ItemNo))+
  geom_point(position = "jitter")+
  #geom_line(group=1)+
  geom_text(aes(label=ItemNo),hjust=0.1, vjust=0.1) + 
 theme_few()+
    guides(color = FALSE)+
 theme_few()+
  xlab("Subjects who rated item as RELATED") + ylab("Subjects who rated item as UNRELATED") + 
  ggtitle("Item Judgments for Path Length 15")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

```

# Item Level Analyses

## Proportion of Subjects

### Plot

```{r}
## we have item_rel_wide and item_rel_rt_wide with RTs and number of subjects
## who called these items related/unrelated for each path length

item_rel_main = merge(item_rel, item_rel_rt,
                      by = c("pathlength", "ItemNo", "Type"))
colnames(item_rel_main) =c ("pathlength", "ItemNo", 
                            "Type", "Trials","rt")

itemrt_agg = Rmisc::summarySE(item_rel_main, 
                        measurevar = "rt",
                        groupvars = c("pathlength", "Type"))

itemrt_agg_collapsed = Rmisc::summarySE(item_rt_collapsed, 
                        measurevar = "rt",
                        groupvars = c("pathlength"))

item_rel_main$Proportion = item_rel_main$Trials/16


item_agg = Rmisc::summarySE(item_rel_main, 
                        measurevar = "Proportion",
                        groupvars = c("pathlength", "Type"))
item_agg$pathlengthfac = ordered(as.factor(as.character(item_agg$pathlength)), 
                            levels = c("1", "2", "3", "4", "6", "15"))

item_agg %>% 
  ggplot(aes(x = pathlengthfac, y = Proportion, group = Type, fill = Type))+
#  geom_smooth(method = "loess")+
 geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
  geom_errorbar(aes(ymin=Proportion - ci, ymax=Proportion + ci), 
             width=.05, color = "gray30", 
             position = position_dodge(0.8))+
 theme_few()+
  scale_fill_solarized()+
  #scale_x_continuous(breaks = c(1,2,3,4,5,6,10,15,20))+
    xlab("Path Length") + ylab("Number of Subjects") + 
  ggtitle("Item-Level Subject Counts for Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

### ANOVA

```{r}

## item_rel_wide has 1200 rows with 0s for items. convert that into wide.

library(tidyr)
item_prop_data = item_rel_wide %>%
  gather(Type, Trials, Related:Unrelated)

item_prop_data$Proportion = item_prop_data$Trials/16

item_prop_data = item_prop_data[order(item_prop_data$ItemNo),]

item_prop_data$pathlengthfac = ordered(as.factor(as.character(item_prop_data$pathlength)), 
                            levels = c("1", "2", "3", "4", "6", "15"))
library(lme4)
itemrelunrel_aov = aov(data = item_prop_data, 
                       Proportion ~ pathlengthfac*Type + 
                     Error(ItemNo/(Type)))
summary(itemrelunrel_aov)

options(contrasts = c('contr.sum', 'contr.poly'))
 library(lsmeans)
 library(multcomp)
 sem_lsm = lsmeans::lsmeans(itemrelunrel_aov, c("pathlengthfac", "Type"))
 prime_effect = cld(sem_lsm, alpha = 0.05, 
                 adjust = "tukey", details = TRUE, by = "pathlengthfac")
 library(knitr)
kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.05))

```


## Raw RT Plot Collapsed

```{r}
itemrt_agg_collapsed$pathlengthfac = ordered(as.factor(as.character(itemrt_agg_collapsed$pathlength)), 
                            levels = c("1", "2", "3", "4", "6", "15"))

itemrt_agg_collapsed %>% 
  ggplot(aes(x = pathlengthfac, y = rt, group = 1))+
#  geom_smooth(method = "loess")+
  geom_point()+
geom_line(color = "red")+
  geom_errorbar(aes(ymin=rt - ci, ymax=rt + ci), 
             width=.05, color = "gray30", 
             position = position_dodge(0))+
 theme_few()+
  #scale_x_continuous(breaks = c(1,2,3,4,5,6,10,15,20))+
    xlab("Path Length") + ylab("Raw RT") + 
  ggtitle("Item-Level Raw RTs for Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```
### RT ANOVA Collapsed

```{r}
item_rt_collapsed$pathlengthfac = ordered(as.factor(as.character(item_rt_collapsed$pathlength)), 
                            levels = c("1", "2", "3", "4", "6", "15"))
item_rt_collapsed$ItemNo = as.factor(item_rt_collapsed$ItemNo)

item_rt_collapsed_aov = aov(data = item_rt_collapsed, 
                            rt ~ pathlengthfac)
summary(item_rt_collapsed_aov)

options(contrasts = c('contr.sum', 'contr.poly'))
 library(lsmeans)
 library(multcomp)
 sem_lsm = lsmeans::lsmeans(item_rt_collapsed_aov, c("pathlengthfac"))
 prime_effect = cld(sem_lsm, alpha = 0.05, 
                 adjust = "tukey", details = TRUE)
 library(knitr)
kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 1 ))

```

## Raw RT Plot Rel-Unrel

```{r}
itemrt_agg$pathlengthfac = ordered(as.factor(as.character(itemrt_agg$pathlength)), 
                            levels = c("1", "2", "3", "4", "6", "15"))

itemrt_agg %>% 
  ggplot(aes(x = pathlengthfac, y = rt, group = Type, color = Type))+
#  geom_smooth(method = "loess")+
  geom_point()+
geom_line()+
  geom_errorbar(aes(ymin=rt - ci, ymax=rt + ci), 
             width=.05, color = "gray30", 
             position = position_dodge(0))+
 theme_few()+
  #scale_x_continuous(breaks = c(1,2,3,4,5,6,10,15,20))+
    xlab("Path Length") + ylab("Raw RT") + 
  ggtitle("Item-Level Raw RTs for Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

### RT ANOVA Rel-Unrel

```{r}
item_rel_main$pathlengthfac = ordered(as.factor(as.character(item_rel_main$pathlength)), 
                            levels = c("1", "2", "3", "4", "6", "15"))
contrasts(item_rel_main$pathlengthfac) = contr.treatment(6, base = 2)

item_rt_aov = lme4::lmer(data = item_rel_main, rt ~ pathlengthfac*Type +
                          (1|ItemNo))
summary(item_rt_aov)
car::Anova(item_rt_aov)

options(contrasts = c('contr.sum', 'contr.poly'))
 library(lsmeans)
 library(multcomp)
 sem_lsm = lsmeans::lsmeans(item_rt_aov, c("pathlengthfac", "Type"))
 prime_effect = cld(sem_lsm, alpha = 0.05, 
                 adjust = "tukey", details = TRUE)
 library(knitr)
kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value <1))


x = sjPlot::plot_model(item_rt_aov, type = "int")

x + geom_line()+
 theme_few()+
  #scale_x_continuous(breaks = c(1,2,3,4,5,6,10,15,20))+
    xlab("Path Length") + ylab("Raw RT") + 
  ggtitle("Raw RT for Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

```

## zRT plot

```{r}
item_rel_rt = group_by(new_sem_z, pathlength, ItemNo, Type) %>%
  summarise_at(vars(rt, zRT_trim), mean)

item_rel_rt_collapsed = Rmisc::summarySE(item_rel_rt, 
                        measurevar = "zRT_trim",
                        groupvars = c("pathlength", "Type"))

item_rel_rt_collapsed$pathlengthfac = ordered(as.factor(as.character(item_rel_rt_collapsed$pathlength)), 
                            levels = c("1", "2", "3", "4", "6", "15"))

item_rel_rt_collapsed %>% 
  ggplot(aes(x = pathlengthfac, y = zRT_trim, group = Type, color = Type))+
#  geom_smooth(method = "loess")+
  geom_point()+
geom_line()+
  geom_errorbar(aes(ymin=zRT_trim - ci, ymax=zRT_trim + ci), 
             width=.05, color  = "gray30", 
             position = position_dodge(0))+
 theme_few()+
  #scale_x_continuous(breaks = c(1,2,3,4,5,6,10,15,20))+
    xlab("Path Length") + ylab("z-RT") + 
  ggtitle("Item-Level z-RTs for Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

```

### zRT ANOVA Rel-Unrel

```{r}
item_rel_rt$pathlengthfac = ordered(as.factor(as.character(item_rel_rt$pathlength)), 
                            levels = c("1", "2", "3", "4", "6", "15"))
contrasts(item_rel_rt$pathlengthfac) = contr.treatment(6, base = 2)

item_zrt_aov = lme4::lmer(data = item_rel_rt, zRT_trim ~ pathlengthfac*Type +
                          (1|ItemNo))
summary(item_zrt_aov)
car::Anova(item_zrt_aov)

options(contrasts = c('contr.sum', 'contr.poly'))
 library(lsmeans)
 library(multcomp)
 sem_lsm = lsmeans::lsmeans(item_zrt_aov, c("pathlengthfac", "Type"))
 prime_effect = cld(sem_lsm, alpha = 0.05, 
                 adjust = "tukey", details = TRUE)
 library(knitr)
kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value <.08))

x = sjPlot::plot_model(item_zrt_aov, type = "int")

x + geom_line()+
 theme_few()+
  #scale_x_continuous(breaks = c(1,2,3,4,5,6,10,15,20))+
    xlab("Path Length") + ylab("Raw RT") + 
  ggtitle("Raw RT for Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

```


# KENETT ANOVAs

```{r}
## for the RT analyses we need to include only related trials for path length 1, and unrelated trials for all 
## other path lengths

# removing trials below 250 ms

sem_kenett = sem %>% filter(rt > 250)

# removing for each participant, trials which were above or below 2.5 SD for each condition were also deleted from final data analysis.

condition_means = group_by(sem, pathlength) %>%
  summarise_at(vars(rt), mean)
condition_sd = group_by(sem, pathlength) %>%
  summarise_at(vars(rt), sd)

condition_agg = merge(condition_means, condition_sd, by = "pathlength")
colnames(condition_agg) = c("pathlength", "meanrt", "sdrt")
condition_agg$MOE = 2.5*condition_agg$sdrt
condition_agg$lower = condition_agg$meanrt - condition_agg$MOE
condition_agg$upper = condition_agg$meanrt + condition_agg$MOE


sem_kenett = merge(sem_kenett, condition_agg, by = "pathlength")
sem_kenett = dplyr::arrange(sem_kenett, subject)

sem_kenett = sem_kenett %>% filter(rt > lower)
sem_kenett = sem_kenett %>% filter(rt < upper)


## further looking at only "successful trials", i.e., related trials for pathlength 1, and unrelated for all others

sem_kenett_final = sem_kenett %>% filter((pathlength == 1 & Type == "Related") | 
                                           (pathlength == 2 & Type == "Unrelated") | 
                                           (pathlength == 3 & Type == "Unrelated") | 
                                           (pathlength == 4 & Type == "Unrelated") | 
                                           (pathlength == 6 & Type == "Unrelated") | 
                                           (pathlength == 15 & Type == "Unrelated") )
```

## Plotting Final Kenett: Overall

```{r}
sem_kenett_agg = Rmisc::summarySE(sem_kenett_final, 
                        measurevar = "rt",
                        groupvars = c("pathlength"))


## Raw RT Plot Rel-Unrel
sem_kenett_agg$pathlengthfac = ordered(as.factor(as.character(sem_kenett_agg$pathlength)), 
                            levels = c("1", "2", "3", "4", "6", "15"))

sem_kenett_agg %>% 
  ggplot(aes(x = pathlengthfac, y = rt, group = 1))+
#  geom_smooth(method = "loess")+
  geom_point()+
geom_line(color = "darkblue")+
  geom_errorbar(aes(ymin=rt - ci, ymax=rt + ci), 
             width=.05, color = "gray30", 
             position = position_dodge(0))+
 theme_few()+
  #scale_x_continuous(breaks = c(1,2,3,4,5,6,10,15,20))+
    xlab("Path Length") + ylab("Raw RT") + 
  ggtitle("Kenett Raw RTs for Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```


## Kenett Anovas

```{r}

sem_kenett_final$subject = as.factor(sem_kenett_final$subject)
sem_kenett_subject = group_by(sem_kenett_final, subject, pathlength) %>%
  summarize_at(vars(rt), mean)

sem_kenett_item = group_by(sem_kenett_final, pathlength, ItemNo) %>%
  summarise_at(vars(rt), mean)

sem_kenett_subject$pathlengthfac = ordered(as.factor(as.character(sem_kenett_subject$pathlength)), 
                            levels = c("1", "2", "3", "4", "6", "15"))
sem_kenett_item$pathlengthfac = ordered(as.factor(as.character(sem_kenett_item$pathlength)), 
                            levels = c("1", "2", "3", "4", "6", "15"))
```
### Subject Level Anova
```{r}
kenett_subject_aov = aov(data = sem_kenett_subject, rt ~ pathlengthfac + 
                           Error(subject/pathlengthfac))
summary(kenett_subject_aov)

options(contrasts = c('contr.sum', 'contr.poly'))
 library(lsmeans)
 library(multcomp)
 kenett_subject_lsm = lsmeans::lsmeans(kenett_subject_aov, c("pathlengthfac"))
 sub_effect = cld(kenett_subject_lsm, alpha = 0.05, 
                 adjust = "tukey", details = TRUE)
 library(knitr)
kable(subset(sub_effect$comparisons,prime_effect$comparisons$p.value < 0.1))
```

## Plotting Final Kenett: Subject

```{r}
sem_kenett_subject_agg = Rmisc::summarySE(sem_kenett_subject, 
                        measurevar = "rt",
                        groupvars = c("pathlength"))


## Raw RT Plot Rel-Unrel
sem_kenett_subject_agg$pathlengthfac = ordered(as.factor(as.character(sem_kenett_subject_agg$pathlength)), 
                            levels = c("1", "2", "3", "4", "6", "15"))

sem_kenett_subject_agg %>% 
  ggplot(aes(x = pathlengthfac, y = rt, group = 1))+
#  geom_smooth(method = "loess")+
  geom_point()+
geom_line(color = "darkblue")+
  geom_errorbar(aes(ymin=rt - ci, ymax=rt + ci), 
             width=.05, color = "gray30", 
             position = position_dodge(0))+
 theme_few()+
  #scale_x_continuous(breaks = c(1,2,3,4,5,6,10,15,20))+
    xlab("Path Length") + ylab("Raw RT") + 
  ggtitle("Subject-Level Kenett Raw RTs for Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```


### Item Level Anova
```{r}

kenett_item_aov = aov(data = sem_kenett_item, rt ~ pathlengthfac)
summary(kenett_item_aov)

options(contrasts = c('contr.sum', 'contr.poly'))
 library(lsmeans)
 library(multcomp)
 kenett_item_lsm = lsmeans::lsmeans(kenett_item_aov, c("pathlengthfac"))
 item_effect = cld(kenett_item_lsm, alpha = 0.05, 
                 adjust = "tukey", details = TRUE)
 library(knitr)
kable(subset(item_effect$comparisons,prime_effect$comparisons$p.value < 0.1))
```

## Plotting Final Kenett: item

```{r}
sem_kenett_item_agg = Rmisc::summarySE(sem_kenett_item, 
                        measurevar = "rt",
                        groupvars = c("pathlength"))


## Raw RT Plot Rel-Unrel
sem_kenett_item_agg$pathlengthfac = ordered(as.factor(as.character(sem_kenett_item_agg$pathlength)), 
                            levels = c("1", "2", "3", "4", "6", "15"))

sem_kenett_item_agg %>% 
  ggplot(aes(x = pathlengthfac, y = rt, group = 1))+
#  geom_smooth(method = "loess")+
  geom_point()+
geom_line(color = "darkblue")+
  geom_errorbar(aes(ymin=rt - ci, ymax=rt + ci), 
             width=.05, color = "gray30", 
             position = position_dodge(0))+
 theme_few()+
  #scale_x_continuous(breaks = c(1,2,3,4,5,6,10,15,20))+
    xlab("Path Length") + ylab("Raw RT") + 
  ggtitle("item-Level Kenett Raw RTs for Relatedness Judgments")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```





```




